for file in folder:
    
    # Create a DataFrame with the observed wavelengths in one column and the difference between that wavelength and
    # each skyline wavelengths in the following columns
    
    difference = pd.DataFrame(file['WAVE'])
    for w in wavel:
        difference[w] = file['WAVE'].sub(w, axis=0)

    # Make the DataFrame into the absolute values of the differences. Then extract the indices of the minimum
    #differences and put into a list

    abs_difference = difference.abs()

    min_indices = []
    for w in wavel:
        index = abs_difference[w].idxmin() 
        min_indices.append(index)

    # Iterate through all indicies and get the observed wavelength of the minimum differences

    obs_wavelengths = []
    obs_intensities = []
    for m in min_indices:
        obs = file.iloc[m][0]
        intensity = file.iloc[m][3]
        obs_wavelengths.append(obs)
        obs_intensities.append(intensity)
    
    # Join the observed wavelengths onto the original sky lines Data Frame and re-calculate the residuals

    temp_skylines = pd.DataFrame(sky_lines['Wave'])
    temp_skylines['Obs'] = obs_wavelengths
    temp_skylines['Residual'] = temp_skylines['Wave'].sub(temp_skylines['Obs'], axis=0)
    temp_skylines = temp_skylines.loc[abs(temp_skylines['Residual']) < 1]
    
    slit_dfs.append(temp_skylines)